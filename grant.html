<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Grant Google Drive Access</title>
<style>
body { font-family: Arial; padding: 20px; max-width: 800px; margin: auto; }
input { width: 250px; padding: 6px; margin: 4px; }
button { padding: 8px 16px; }
</style>
</head>
<body>

<h2>Grant Google Drive Access</h2>
<p>Provide the Customer ID (given by admin) and click Allow. This will open Google consent screen.</p>

<label>Customer ID</label><br>
<input id="cust" placeholder="e.g. ACME123"><br><br>

<label>GAS Redirect URL</label><br>
<input id="redirect" placeholder="https://script.google.com/macros/s/.../exec"><br><br>

<label>Google OAuth Client ID</label><br>
<input id="cid" placeholder="12345.apps.googleusercontent.com"><br><br>

<label>Admin URL</label><br>
<input id="admin" placeholder="https://your-admin.com"><br><br>

<button onclick="startGrant()">Allow</button>

<script>
function startGrant() {
    const cust = document.getElementById("cust").value;
    const red = document.getElementById("redirect").value;
    const cid = document.getElementById("cid").value;
    const admin = document.getElementById("admin").value;

    if(!cust || !red || !cid){
        alert("Please fill Customer ID, Redirect URL and Client ID");
        return;
    }

    // GAS will use the secret (not customer)
    const state = btoa(JSON.stringify({cust_id: cust, admin_url: admin}));

    const url =
      "https://accounts.google.com/o/oauth2/v2/auth?" +
      "client_id=" + encodeURIComponent(cid) +
      "&redirect_uri=" + encodeURIComponent(red) +
      "&response_type=code" +
      "&scope=" + encodeURIComponent("https://www.googleapis.com/auth/drive.file") +
      "&access_type=offline" +
      "&prompt=consent" +
      "&state=" + encodeURIComponent(state);

    window.location = url;
}
</script>

</body>
</html>
